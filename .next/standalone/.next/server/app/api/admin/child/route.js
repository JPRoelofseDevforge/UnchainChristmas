"use strict";(()=>{var e={};e.id=361,e.ids=[361],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},4080:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>I,requestAsyncStorage:()=>x,routeModule:()=>w,serverHooks:()=>g,staticGenerationAsyncStorage:()=>y});var a={};t.r(a),t.d(a,{DELETE:()=>m,GET:()=>u,POST:()=>p,PUT:()=>h});var s=t(9303),i=t(8716),n=t(670),o=t(7070),d=t(728),c=t(2023),l=t.n(c);async function p(e){try{let{email:r,password:t,name:a,age:s,partyId:i,wishlist:n}=await e.json(),c=await d._.adminUser.findUnique({where:{email:r}});if(!c||!await l().compare(t,c.password))return o.NextResponse.json({error:"Invalid credentials"},{status:401});let p=await d._.child.create({data:{name:a,age:parseInt(s),partyId:parseInt(i)}});return n&&Array.isArray(n)&&await d._.wishlistItem.createMany({data:n.map(e=>({childId:p.id,text:e}))}),o.NextResponse.json({success:!0,child:p})}catch(e){return console.error("Error creating child:",e),o.NextResponse.json({error:"Failed to create child"},{status:500})}}async function u(){try{let e=await d._.child.findMany({include:{party:!0,wishlist:!0,pledges:!0},orderBy:{createdAt:"desc"}});return o.NextResponse.json(e)}catch(e){return console.error("Error fetching children:",e),o.NextResponse.json({error:"Failed to fetch children"},{status:500})}}async function h(e){try{let{email:r,password:t,id:a,name:s,age:i,partyId:n,pledged:c,wishlist:p}=await e.json(),u=await d._.adminUser.findUnique({where:{email:r}});if(!u||!await l().compare(t,u.password))return o.NextResponse.json({error:"Invalid credentials"},{status:401});let h=await d._.child.update({where:{id:parseInt(a)},data:{name:s,age:parseInt(i),partyId:parseInt(n),pledged:c||!1}});if(p&&Array.isArray(p)){await d._.wishlistItem.deleteMany({where:{childId:parseInt(a)}});let e=p.filter(e=>""!==e.trim());e.length>0&&await d._.wishlistItem.createMany({data:e.map(e=>({childId:parseInt(a),text:e}))})}return o.NextResponse.json({success:!0,child:h})}catch(e){return console.error("Error updating child:",e),o.NextResponse.json({error:"Failed to update child"},{status:500})}}async function m(e){try{let{searchParams:r}=new URL(e.url),t=r.get("id"),a=r.get("email"),s=r.get("password"),i=await d._.adminUser.findUnique({where:{email:a}});if(!i||!await l().compare(s,i.password))return o.NextResponse.json({error:"Invalid credentials"},{status:401});return await d._.child.delete({where:{id:parseInt(t)}}),o.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting child:",e),o.NextResponse.json({error:"Failed to delete child"},{status:500})}}let w=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/child/route",pathname:"/api/admin/child",filename:"route",bundlePath:"app/api/admin/child/route"},resolvedPagePath:"c:\\Work\\UnchainChristmas\\src\\app\\api\\admin\\child\\route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:x,staticGenerationAsyncStorage:y,serverHooks:g}=w,f="/api/admin/child/route";function I(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:y})}},728:(e,r,t)=>{t.d(r,{_:()=>s});let a=require("@prisma/client"),s=globalThis.prisma??new a.PrismaClient}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[948,972,23],()=>t(4080));module.exports=a})();